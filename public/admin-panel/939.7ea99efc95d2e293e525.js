(self.webpackChunkrollet_admin_panel=self.webpackChunkrollet_admin_panel||[]).push([[939],{1939:(e,t,r)=>{"use strict";r.r(t),r.d(t,{WheelModule:()=>w});var i=r(1116),n=r(5141),s=r(4613),d=r(8619),o=r(7727),p=r(6599),a=r(9589),l=r(1225),c=r(2693);let u=(()=>{class e{constructor(e,t){this.http=e,this.router=t,this.prizes=new a.t}fetchPrizes(){return this.http.get("/api/dashboard/wheel/prizes").pipe((0,o.K)(this.handleError),(0,p.b)(e=>{this.prizes.next(e.prizes)}))}addPrize(e){return this.http.post("/api/dashboard/wheel/prize",{prizeType:e.prize.prizeType,reward:e.prize.reward,percent:e.percent}).pipe((0,o.K)(this.handleError))}editPrize(e){return this.http.put(`/api/dashboard/wheel/prize/${e._id}`,{prizeType:e.prize.prizeType,reward:e.prize.reward,percent:e.percent}).pipe((0,o.K)(this.handleError))}deletePrize(e){return this.http.delete(`/api/dashboard/wheel/prize/${e}`).pipe((0,o.K)(this.handleError))}handleError(e){let t="\u0639\u0630\u0631\u0627\u060c \u062d\u062f\u062b \u062e\u0637\u0623 \u0645\u0627.";const r=e.error.message;switch(r){case(r.match(/^MAX_/)||{}).input:t=`\u0627\u0642\u0635\u064a \u0639\u062f\u062f \u0647\u0648 ${r.split("_")[1]}`}return(0,l._)(t)}}return e.\u0275fac=function(t){return new(t||e)(d.LFG(c.eN),d.LFG(n.F0))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var h=r(3851),g=r(1462);function Z(e,t){if(1&e&&(d.TgZ(0,"option",19),d._uU(1),d.qZA()),2&e){const e=t.$implicit;d.Q6J("value",e.en),d.xp6(1),d.hij(" ",e.ar," ")}}const z=function(e,t){return{"bg-primary":e,"bg-success":t}},f=function(e,t){return{"btn-primary":e,"btn-success":t}};let m=(()=>{class e{constructor(e,t){this.wheelService=e,this.alertService=t,this.prizesChanged=new d.vpe,this.prizeTypes=[{en:"points",ar:"\u0646\u0642\u0627\u0637"}]}ngOnInit(){}ngOnChanges(){var e,t,r,i,n;console.log(this.prize),this.prizeType=null===(t=null===(e=this.prize)||void 0===e?void 0:e.prize)||void 0===t?void 0:t.prizeType,this.reward=null===(i=null===(r=this.prize)||void 0===r?void 0:r.prize)||void 0===i?void 0:i.reward,this.percent=null===(n=this.prize)||void 0===n?void 0:n.percent}onSubmit(e){if(e.invalid)return;const{prizeType:t,reward:r,percent:i}=e.value;let n,d={prize:{prizeType:t,reward:r},percent:i};this.edit?(d._id=this.prize._id,n=this.wheelService.editPrize(d)):n=this.wheelService.addPrize(d),n.subscribe(e=>{this.edit||(d=e.prize);const t=new s.b("success","\u0639\u0645\u0644\u064a\u0629 \u0646\u0627\u062c\u062d\u0647",this.edit?"\u062a\u0645 \u062a\u0639\u062f\u064a\u0644 \u0627\u0644\u062c\u0627\u0626\u0632\u0647 \u0628\u0646\u062c\u0627\u062d":"\u062a\u0645 \u0627\u0636\u0627\u0641\u0629 \u062c\u0627\u0626\u0632\u062e \u062c\u062f\u064a\u062f\u0647 \u0628\u0646\u062c\u0627\u062d");this.alertService.addAlert(t),this.prizesChanged.emit({edit:this.edit,prize:d})},e=>{const t=new s.b("danger","\u0639\u0645\u0644\u064a\u0629 \u0641\u0627\u0634\u0644\u0629",e);this.alertService.addAlert(t)})}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(u),d.Y36(h.c))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-prize"]],inputs:{edit:"edit",prize:"prize"},outputs:{prizesChanged:"prizesChanged"},features:[d.TTD],decls:26,vars:15,consts:[[1,"modal","fade",3,"id"],[1,"modal-dialog","modal-dialog-centered","modal-dialog-scrollable","modal-lg"],[1,"modal-content"],[1,"modal-header","text-white",3,"ngClass"],[1,"modal-title"],["type","button","data-bs-dismiss","modal",1,"btn-close"],[1,"modal-body"],[3,"ngSubmit"],["f","ngForm"],[1,"form-group"],["for","prizeType"],["name","prizeType","required","",1,"form-control","text-start",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["for","reward"],["type","number","name","reward","required","",1,"form-control","text-start",3,"ngModel","ngModelChange"],["for","percent"],["type","number","name","percent","required","","min","0",1,"form-control","text-start",3,"ngModel","ngModelChange"],[1,"modal-footer"],["data-bs-dismiss","modal",1,"btn",3,"ngClass","click"],[3,"value"]],template:function(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.TgZ(2,"div",2),d.TgZ(3,"div",3),d.TgZ(4,"h5",4),d._uU(5),d.qZA(),d._UZ(6,"button",5),d.qZA(),d.TgZ(7,"div",6),d.TgZ(8,"form",7,8),d.NdJ("ngSubmit",function(){d.CHM(e);const r=d.MAs(9);return t.onSubmit(r)}),d.TgZ(10,"div",9),d.TgZ(11,"label",10),d._uU(12,"\u0646\u0648\u0639 \u0627\u0644\u062c\u0627\u0626\u0632\u0629"),d.qZA(),d.TgZ(13,"select",11),d.NdJ("ngModelChange",function(e){return t.prizeType=e}),d.YNc(14,Z,2,2,"option",12),d.qZA(),d.qZA(),d.TgZ(15,"div",9),d.TgZ(16,"label",13),d._uU(17,"\u0627\u0644\u062c\u0627\u0626\u0632\u0629"),d.qZA(),d.TgZ(18,"input",14),d.NdJ("ngModelChange",function(e){return t.reward=e}),d.qZA(),d.qZA(),d.TgZ(19,"div",9),d.TgZ(20,"label",15),d._uU(21,"\u0646\u0633\u0628\u0629 \u0627\u0644\u0641\u0648\u0632"),d.qZA(),d.TgZ(22,"input",16),d.NdJ("ngModelChange",function(e){return t.percent=e}),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(23,"div",17),d.TgZ(24,"button",18),d.NdJ("click",function(){d.CHM(e);const r=d.MAs(9);return t.onSubmit(r)}),d._uU(25),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()}2&e&&(d.Q6J("id",t.edit?"editPrizeModal":"addPrizeModal"),d.xp6(3),d.Q6J("ngClass",d.WLB(9,z,t.edit,!t.edit)),d.xp6(2),d.hij(" ",t.edit?"\u062a\u0639\u062f\u064a\u0644":"\u0627\u0636\u0627\u0641\u0647"," \u062c\u0627\u0626\u0632\u0647 "),d.xp6(8),d.Q6J("ngModel",t.prizeType),d.xp6(1),d.Q6J("ngForOf",t.prizeTypes),d.xp6(4),d.Q6J("ngModel",t.reward),d.xp6(4),d.Q6J("ngModel",t.percent),d.xp6(2),d.Q6J("ngClass",d.WLB(12,f,t.edit,!t.edit)),d.xp6(1),d.hij(" ",t.edit?"\u062a\u0639\u062f\u064a\u0644":"\u0627\u0636\u0627\u0641\u0647"," "))},directives:[i.mk,g._Y,g.JL,g.F,g.EJ,g.Q7,g.JJ,g.On,i.sg,g.wV,g.Fj,g.qQ,g.YN,g.Kr],styles:[""]}),e})();function b(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"tr"),d.TgZ(1,"td"),d.TgZ(2,"span"),d._uU(3),d.qZA(),d.qZA(),d.TgZ(4,"td"),d.TgZ(5,"span"),d._uU(6),d.qZA(),d.qZA(),d.TgZ(7,"td"),d.TgZ(8,"span"),d._uU(9),d.qZA(),d.qZA(),d.TgZ(10,"td"),d.TgZ(11,"a",11),d.NdJ("click",function(){const t=d.CHM(e).$implicit;return d.oxw().onEdit(t)}),d._uU(12," \u062a\u0639\u062f\u064a\u0644 "),d.qZA(),d.TgZ(13,"button",12),d.NdJ("click",function(){const t=d.CHM(e).$implicit;return d.oxw().onDelete(t._id)}),d._uU(14," \u062d\u0630\u0641 "),d.qZA(),d.qZA(),d.qZA()}if(2&e){const e=t.$implicit;d.xp6(3),d.Oqu(e.prize.prizeType),d.xp6(3),d.Oqu(e.prize.reward),d.xp6(3),d.Oqu(e.percent)}}let T=(()=>{class e{constructor(e,t){this.wheelService=e,this.alertService=t}ngOnInit(){this.wheelService.prizes.subscribe(e=>{this.prizes=e})}onEdit(e){this.selectedPrize=e}onDelete(e){this.wheelService.deletePrize(e).subscribe(()=>{this.prizes.splice(this.prizes.findIndex(t=>t._id===e),1);const t=new s.b("success","\u0639\u0645\u0644\u064a\u0629 \u0646\u0627\u062c\u062d\u0647","\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u062c\u0627\u0626\u0632\u0647 \u0628\u0646\u062c\u0627\u062d");this.alertService.addAlert(t)},e=>{const t=new s.b("danger","\u0639\u0645\u0644\u064a\u0629 \u0641\u0627\u0634\u0644\u0629",e);this.alertService.addAlert(t)})}onPrizeChange({edit:e,prize:t}){e?this.prizes[this.prizes.findIndex(e=>e._id===t._id)]=t:this.prizes.push(t)}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(u),d.Y36(h.c))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-wheel"]],decls:23,vars:4,consts:[[1,"d-flex","justify-content-between","flex-wrap","flex-md-nowrap","align-items-center","pt-3","pb-2","mb-3","border-bottom"],[1,"h2"],["id","actions",1,""],[1,"container"],[1,"row"],[1,"col"],["href","#","data-bs-toggle","modal","data-bs-target","#addPrizeModal","type","submit",1,"btn","btn-success","btn-lg"],[1,"table","table-striped","table-sm"],[4,"ngFor","ngForOf"],[3,"prize","edit","prizesChanged"],[3,"edit","prizesChanged"],["href","#","data-bs-toggle","modal","data-bs-target","#editPrizeModal","type","submit",1,"btn","btn-primary","mx-2",3,"click"],[1,"btn","btn-danger",3,"click"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"h1",1),d._uU(2,"\u0639\u062c\u0644\u0629 \u0627\u0644\u062d\u0638"),d.qZA(),d.qZA(),d.TgZ(3,"section",2),d.TgZ(4,"div",3),d.TgZ(5,"div",4),d.TgZ(6,"div",5),d.TgZ(7,"a",6),d._uU(8," \u0627\u0636\u0627\u0641\u0629 "),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(9,"table",7),d.TgZ(10,"thead"),d.TgZ(11,"tr"),d.TgZ(12,"th"),d._uU(13,"\u0646\u0648\u0639 \u0627\u0644\u062c\u0627\u0626\u0632\u0647"),d.qZA(),d.TgZ(14,"th"),d._uU(15,"\u0627\u0644\u062c\u0627\u0626\u0632\u0647"),d.qZA(),d.TgZ(16,"th"),d._uU(17,"\u0646\u0633\u0628\u0629 \u0627\u0644\u0641\u0648\u0632"),d.qZA(),d._UZ(18,"th"),d.qZA(),d.qZA(),d.TgZ(19,"tbody"),d.YNc(20,b,15,3,"tr",8),d.qZA(),d.qZA(),d.TgZ(21,"app-prize",9),d.NdJ("prizesChanged",function(e){return t.onPrizeChange(e)}),d.qZA(),d.TgZ(22,"app-prize",10),d.NdJ("prizesChanged",function(e){return t.onPrizeChange(e)}),d.qZA()),2&e&&(d.xp6(20),d.Q6J("ngForOf",t.prizes),d.xp6(1),d.Q6J("prize",t.selectedPrize)("edit",!0),d.xp6(1),d.Q6J("edit",!1))},directives:[i.sg,m],styles:[""]}),e})();const v=[{path:"",resolve:[(()=>{class e{constructor(e){this.wheelService=e}resolve(e,t){return this.wheelService.fetchPrizes()}}return e.\u0275fac=function(t){return new(t||e)(d.LFG(u))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()],component:T,data:{title:"\u0639\u062c\u0644\u0629 \u0627\u0644\u062d\u0638"}}];let A=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[n.Bz.forChild(v)],n.Bz]}),e})();var q=r(1661);let w=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[i.ez,A,g.u5,q.p]]}),e})()}}]);