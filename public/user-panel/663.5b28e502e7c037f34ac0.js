(self.webpackChunkrollet_user_panel=self.webpackChunkrollet_user_panel||[]).push([[663],{4663:(e,t,i)=>{"use strict";i.r(t),i.d(t,{DashboardModule:()=>M});var n=i(5141),r=i(8619),s=i(7727),o=i(6599),l=i(9589),h=i(1225),a=i(2693);let c=(()=>{class e{constructor(e,t){this.http=e,this.router=t,this.user=new l.t,this.pointChange=new l.t}fetchProfile(){return this.http.get("/api/user/profile").pipe((0,s.K)(this.handleError),(0,o.b)(e=>{this.user.next(e.user)}))}handleError(e){return(0,h._)("\u0639\u0630\u0631\u0627\u060c \u062d\u062f\u062b \u062e\u0637\u0623 \u0645\u0627.")}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(a.eN),r.LFG(n.F0))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function p(e,t,i,n,r,s,o){try{var l=e[s](o),h=l.value}catch(a){return void i(a)}l.done?t(h):Promise.resolve(h).then(n,r)}var u=i(4613),w=function(e){return e.INNER="inner",e.OUTER="outer",e.CENTER="center",e}({}),d=function(e){return e.HORIZONTAL="horizontal",e.VERTICAL="vertical",e.CURVED="curved",e}({});let f=(()=>{class e{constructor(){this.onSpinStart=new r.vpe,this.onSpinComplete=new r.vpe,this.completedSpin=!1,this.isSpinning=!1}reset(){this.wheel.stopAnimation(!1),this.wheel.rotationAngle=0,this.wheel.ctx.clearRect(0,0,this.wheel.ctx.canvas.width,this.wheel.ctx.canvas.height),this.isSpinning=!1,this.completedSpin=!1,this.ngAfterViewInit()}ngOnInit(){}spin(e){if(this.completedSpin||this.isSpinning)return;this.isSpinning=!0,this.onSpinStart.emit(null);const t=this.wheel.segments.filter(e=>!!e).find(({id:t})=>e===t);this.wheel.animation.stopAngle=t.endAngle-(t.endAngle-t.startAngle)/4,this.wheel.startAnimation(),setTimeout(()=>{this.completedSpin=!0,this.onSpinComplete.emit(null)},1e3*this.spinDuration)}ngAfterViewInit(){const e=this.items;this.wheel=new Winwheel({numSegments:e.length,segments:e,innerRadius:this.innerRadius||0,outerRadius:this.height/2-20,centerY:this.height/2+20,textOrientation:this.textOrientation,textAligment:this.textAlignment,animation:{type:"spinToStop",duration:this.spinDuration,spins:this.spinAmount}}),TweenMax.ticker.addEventListener("tick",this.drawPointer.bind(this))}ngOnDestroy(){TweenMax.ticker.removeEventListener("tick")}drawPointer(){let e=this.wheel.ctx;e&&(e.save(),e.lineWidth=2,e.strokeStyle=this.pointerStrokeColor,e.fillStyle=this.pointerFillColor,e.beginPath(),e.moveTo(this.width/2-20,2),e.lineTo(this.width/2+20,2),e.lineTo(this.width/2,42),e.lineTo(this.width/2-20,2),e.stroke(),e.fill(),e.restore())}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-wheel"]],inputs:{height:"height",width:"width",items:"items",spinDuration:"spinDuration",spinAmount:"spinAmount",innerRadius:"innerRadius",pointerStrokeColor:"pointerStrokeColor",pointerFillColor:"pointerFillColor",disableSpinOnClick:"disableSpinOnClick",textOrientation:"textOrientation",textAlignment:"textAlignment"},outputs:{onSpinStart:"onSpinStart",onSpinComplete:"onSpinComplete"},decls:2,vars:2,consts:[["id","canvas",3,"width","height"]],template:function(e,t){1&e&&(r.TgZ(0,"canvas",0),r._uU(1," \xa0\xa0\xa0\xa0Canvas not supported, use another browser. "),r.qZA()),2&e&&r.Q6J("width",t.width)("height",t.height)},encapsulation:2}),e})(),m=(()=>{class e{constructor(e,t){this.http=e,this.router=t,this.wheel=new l.t}fetchWheel(){return this.http.get("/api/wheel/prizes").pipe((0,s.K)(this.handleError),(0,o.b)(e=>{this.wheel.next(e.prizes)}))}spin(){return this.http.post("/api/wheel/spin",{}).pipe((0,s.K)(this.handleError))}handleError(e){let t="\u0639\u0630\u0631\u0627\u060c \u062d\u062f\u062b \u062e\u0637\u0623 \u0645\u0627.";switch(e.error.message){case"USER_NOTFOUNT":t="\u0644\u0627 \u064a\u0648\u062c\u062f \u0645\u0633\u062a\u062e\u062f\u0645 \u0628\u0647\u0630\u0627 \u0627\u0644\u0627\u0633\u0645.";break;case"NUMBER_MIN_0":t="\u0628\u0631\u062c\u0627\u0621 \u0627\u062f\u062e\u0627\u0644 \u0639\u062f\u062f \u0635\u062d\u064a\u062d.";break;case"NEGATIVE_POINTS":t="\u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645 \u0644\u0627 \u064a\u0645\u062a\u0644\u0643 \u0645\u0627 \u064a\u0643\u0641\u064a \u0645\u0646 \u0627\u0644\u0646\u0642\u0627\u0637."}return(0,h._)(t)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(a.eN),r.LFG(n.F0))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var g=i(3851);let v=(()=>{class e{constructor(e,t,i){this.wheelService=e,this.homeService=t,this.alertService=i,this.textOrientation=d.HORIZONTAL,this.textAlignment=w.OUTER,this.spinning=!1,this.prizeTranslate={points:"\u0646\u0642\u0627\u0637"}}ngOnInit(){const e=["#FF0000","#000000","#333"];this.wheelService.wheel.subscribe(t=>{this.wheelPrizes=t;for(let e=t.length-1;e>0;e--){let i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}this.items=t.map((t,i)=>({fillStyle:e[i%3],text:`${t.prize.reward} ${this.prizeTranslate[t.prize.prizeType]}`,id:t.id,textFillStyle:"white",textFontSize:"16"}))})}reset(){this.wheel.reset()}before(){this.spinning=!0,this.homeService.pointChange.next(-5)}spin(){var e,t=this;return(e=function*(){t.wheelService.spin().subscribe(({prizeId:e})=>{t.reset(),t.wheel.spin(e),t.winPrize=t.wheelPrizes.find(t=>t.id===e)})},function(){var t=this,i=arguments;return new Promise(function(n,r){var s=e.apply(t,i);function o(e){p(s,n,r,o,l,"next",e)}function l(e){p(s,n,r,o,l,"throw",e)}o(void 0)})})()}after(){this.spinning=!1,this.homeService.pointChange.next(this.winPrize.prize.reward);const e=new u.b("success","\u0645\u0628\u0631\u0648\u0643",`\u062a\u0645 \u0627\u0644\u0641\u0648\u0632 \u0628 ${this.winPrize.prize.reward} \u0646\u0642\u0637\u0629`);this.alertService.addAlert(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(m),r.Y36(c),r.Y36(g.c))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-lottery-wheel"]],viewQuery:function(e,t){if(1&e&&r.Gf(f,5),2&e){let e;r.iGM(e=r.CRH())&&(t.wheel=e.first)}},decls:5,vars:9,consts:[[1,"row","flex-column"],["pointerStrokeColor","black","pointerFillColor","gold",3,"width","height","spinDuration","items","innerRadius","spinAmount","textOrientation","textAlignment","onSpinStart","onSpinComplete"],["wheel",""],[1,"btn","btn-success",3,"disabled","click"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"app-wheel",1,2),r.NdJ("onSpinStart",function(){return t.before()})("onSpinComplete",function(){return t.after()}),r.qZA(),r.TgZ(3,"button",3),r.NdJ("click",function(){return t.spin()}),r._uU(4," Spin "),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("width",400)("height",400)("spinDuration",8)("items",t.items)("innerRadius",20)("spinAmount",10)("textOrientation",t.textOrientation)("textAlignment",t.textAlignment),r.xp6(2),r.Q6J("disabled",t.spinning))},directives:[f],styles:[""]}),e})(),x=(()=>{class e{constructor(e){this.homeService=e}ngOnInit(){this.homeService.user.subscribe(e=>{this.user=e}),this.homeService.pointChange.subscribe(e=>{this.user.points+=e})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(c))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-home"]],decls:11,vars:3,consts:[["id","profile"],[1,"container"],[1,"profile","d-flex"],["src","/assets/img/avatar.png","alt","",1,"rounded-circle"],[1,"data","ms-4"],[1,"lead","userName"],[1,"lead","Points"],["id","wheel","dir","ltr",1,"py-4","d-flex","justify-content-center"]],template:function(e,t){1&e&&(r.TgZ(0,"section",0),r.TgZ(1,"div",1),r.TgZ(2,"div",2),r._UZ(3,"img",3),r.TgZ(4,"div",4),r.TgZ(5,"p",5),r._uU(6),r.qZA(),r.TgZ(7,"p",6),r._uU(8),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(9,"section",7),r._UZ(10,"app-lottery-wheel"),r.qZA()),2&e&&(r.xp6(6),r.AsE(" ",t.user.firstName," ",t.user.lastName," "),r.xp6(2),r.hij("",t.user.points," \u0646\u0642\u0637\u0629"))},directives:[v],styles:[".profile[_ngcontent-%COMP%]   .userName[_ngcontent-%COMP%]{font-size:40px}.profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:70px;height:70px}#wheel[_ngcontent-%COMP%]{font-family:Arial,Helvetica,sans-serif}"]}),e})(),S=(()=>{class e{constructor(e){this.homeService=e}resolve(e,t){return this.homeService.fetchProfile()}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(c))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const y=[{path:"",resolve:[(()=>{class e{constructor(e){this.wheelService=e}resolve(e,t){return this.wheelService.fetchWheel()}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(m))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),S],component:x,data:{title:"\u0627\u0644\u0631\u0626\u064a\u0633\u064a\u0629"}}];let A=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[n.Bz.forChild(y)],n.Bz]}),e})();var C=i(1116),b=i(1462);let T=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[C.ez,b.u5],C.ez,b.u5]}),e})();class k{constructor(e){this.icons=e}}let z=(()=>{class e{constructor(e){if(this.icons=e,!this.icons)throw new Error("No icon provided. Make sure to use 'FeatherModule.pick({ ... })' when importing the module\nRefer to documentation on https://github.com/michaelbazos/angular-feather")}static pick(t){return{ngModule:e,providers:[{provide:k,multi:!0,useValue:t}]}}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(k,8))},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({}),e})();const O={Home:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-home">\n    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline>\n</svg>',Users:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-users">\n    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path>\n</svg>',BarChart2:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-bar-chart-2">\n    <line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line>\n</svg>',Minus:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-minus">\n    <line x1="5" y1="12" x2="19" y2="12"></line>\n</svg>',Plus:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-plus">\n    <line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line>\n</svg>',Aperture:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-aperture">\n    <circle cx="12" cy="12" r="10"></circle><line x1="14.31" y1="8" x2="20.05" y2="17.94"></line><line x1="9.69" y1="8" x2="21.17" y2="8"></line><line x1="7.38" y1="12" x2="13.12" y2="2.06"></line><line x1="9.69" y1="16" x2="3.95" y2="6.06"></line><line x1="14.31" y1="16" x2="2.83" y2="16"></line><line x1="16.62" y1="12" x2="10.88" y2="21.94"></line>\n</svg>'};let Z=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[z.pick(O)],z]}),e})(),M=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[T,Z,A]]}),e})()}}]);